<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhrustV2 Minecraft Server</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Roboto', sans-serif; 
            background-color: #000; 
            color: #f0f0f0; 
            line-height: 1.6; 
            background: linear-gradient(rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.9)), url('https://images.unsplash.com/photo-1550745165-9bc0b252726f?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
            background-size: cover; 
            background-attachment: fixed; 
            background-position: center; 
            min-height: 100vh; 
        }
        header { background: rgba(0, 0, 0, 0.95); padding: 15px 0; border-bottom: 3px solid #D32F2F; position: sticky; top: 0; z-index: 1000; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.8); }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .header-container { display: flex; justify-content: space-between; align-items: center; }
        .logo { display: flex; align-items: center; gap: 15px; text-decoration: none; color: inherit; }
        .logo-img { width: 50px; height: 50px; border-radius: 50%; border: 3px solid #D32F2F; box-shadow: 0 0 15px rgba(211, 47, 47, 0.5); }
        .logo-text { font-family: 'Orbitron', sans-serif; font-weight: 900; font-size: 24px; color: #FF5252; text-shadow: 0 0 10px rgba(255, 82, 82, 0.7); }
        nav ul { display: flex; list-style: none; gap: 20px; }
        nav a { color: #f0f0f0; text-decoration: none; font-weight: 600; padding: 10px 20px; border-radius: 6px; transition: all 0.3s; font-family: 'Orbitron', sans-serif; }
        nav a:hover, nav a.active { background: #D32F2F; color: white; box-shadow: 0 0 15px rgba(211, 47, 47, 0.5); }
        .page { display: none; padding: 40px 0; }
        .page.active { display: block; }
        .discord-invite { background: #2f3136; border-radius: 8px; padding: 16px; margin-bottom: 30px; border: 1px solid #202225; max-width: 432px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        .discord-header { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
        .discord-icon { width: 50px; height: 50px; border-radius: 50%; background: #5865F2; display: flex; align-items: center; justify-content: center; font-size: 24px; color: white; font-weight: bold; flex-shrink: 0; overflow: hidden; }
        .discord-icon img { width: 100%; height: 100%; object-fit: cover; }
        .discord-info h3 { color: white; font-size: 16px; font-weight: 600; margin-bottom: 4px; }
        .discord-info p { color: #b9bbbe; font-size: 14px; }
        .discord-members { display: flex; align-items: center; gap: 8px; margin-bottom: 12px; padding: 8px 0; border-top: 1px solid #202225; border-bottom: 1px solid #202225; }
        .online-indicator { display: inline-block; width: 8px; height: 8px; background: #3ba55c; border-radius: 50%; margin-right: 4px; }
        .member-count { color: #b9bbbe; font-size: 14px; }
        .member-count strong { color: white; }
        .join-btn { background: #5865F2; color: white; border: none; width: 100%; padding: 10px; border-radius: 3px; font-weight: 500; cursor: pointer; transition: background 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 14px; }
        .join-btn:hover { background: #4752c4; }
        .server-info { background: rgba(30, 30, 30, 0.9); border-radius: 10px; padding: 20px; margin-bottom: 20px; border: 1px solid #333; }
        .section-title { font-family: 'Orbitron', sans-serif; color: #FF5252; font-size: 20px; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #D32F2F; }
        .server-ip { background: rgba(10, 10, 10, 0.8); padding: 15px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #D32F2F; }
        .server-ip-title { color: #FF5252; font-weight: bold; margin-bottom: 5px; display: flex; align-items: center; gap: 8px; font-family: 'Orbitron', sans-serif; }
        .server-ip-address { font-family: monospace; background: #000; padding: 8px; border-radius: 4px; color: #FF5252; display: flex; justify-content: space-between; align-items: center; border: 1px solid #333; }
        .copy-btn { background: #8B0000; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; transition: background 0.3s; }
        .copy-btn:hover { background: #D32F2F; }
        .description { margin-top: 15px; font-style: italic; color: #b9bbbe; padding: 15px; background: rgba(10, 10, 10, 0.7); border-radius: 6px; text-align: center; border: 1px solid #333; }
        .main-content { display: grid; grid-template-columns: 300px 1fr; gap: 30px; margin-top: 30px; }
        .sidebar { position: sticky; top: 100px; height: fit-content; }
        .cave-form { background: rgba(30, 30, 30, 0.9); border-radius: 10px; padding: 20px; border: 1px solid #333; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; color: #FF5252; font-weight: 500; font-family: 'Orbitron', sans-serif; }
        .input-control { width: 100%; padding: 10px; background: rgba(10, 10, 10, 0.8); border: 1px solid #333; border-radius: 4px; color: #f0f0f0; font-family: 'Roboto', sans-serif; }
        .input-control:focus { outline: none; border-color: #D32F2F; }
        .form-control { width: 100%; padding: 10px; background: rgba(10, 10, 10, 0.8); border: 1px solid #333; border-radius: 4px; color: #f0f0f0; font-family: 'Roboto', sans-serif; resize: vertical; min-height: 100px; }
        .form-control:focus { outline: none; border-color: #D32F2F; }
        .send-btn { background: #D32F2F; color: white; border: none; padding: 12px 30px; border-radius: 4px; font-weight: 600; cursor: pointer; transition: background 0.3s; display: flex; align-items: center; gap: 10px; margin: 20px auto 0; font-family: 'Orbitron', sans-serif; }
        .send-btn:hover { background: #FF5252; }
        .send-btn:disabled { background: #555; cursor: not-allowed; }
        footer { margin-top: 40px; text-align: center; padding: 20px; background: rgba(0, 0, 0, 0.95); border-top: 3px solid #D32F2F; color: #b9bbbe; font-size: 14px; }
        .message { padding: 15px; border-radius: 6px; margin-bottom: 15px; display: none; }
        .message.success { background: rgba(59, 165, 92, 0.1); border: 1px solid #3ba55c; color: #3ba55c; }
        .message.error { background: rgba(237, 66, 69, 0.1); border: 1px solid #ed4245; color: #ed4245; }
        .message.show { display: block; }
        .loader { border: 3px solid rgba(255, 255, 255, 0.1); border-radius: 50%; border-top: 3px solid #D32F2F; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 20px auto; display: none; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .discord-profile { display: flex; align-items: center; gap: 15px; background: rgba(30, 30, 30, 0.9); padding: 15px; border-radius: 8px; margin-top: 20px; border: 1px solid #333; }
        .discord-avatar { width: 50px; height: 50px; border-radius: 50%; border: 2px solid #5865F2; }
        .discord-profile-info h4 { color: white; margin-bottom: 5px; }
        .discord-profile-info p { color: #b9bbbe; font-size: 14px; }
        .cooldown-timer { text-align: center; font-size: 20px; color: #FF5252; font-family: 'Orbitron', sans-serif; margin: 10px 0; }
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <a href="#" class="logo" id="homeLogo">
                <img src="https://ik.imagekit.io/x7wxtmxra/c61293e3ec5494dafade8929187016cd.webp" alt="PhrustV2 Logo" class="logo-img">
                <span class="logo-text">PHRUSTV2</span>
            </a>
            <nav>
                <ul id="navMenu">
                    <li><a href="#home" class="nav-link active" data-page="home">Home</a></li>
                    <li><a href="#unraidable-cave" class="nav-link" data-page="unraidable-cave">Unraidable Cave</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="container">
        <!-- Home Page -->
        <div id="home-page" class="page active">
            <div class="main-content">
                <aside class="sidebar">
                    <div class="server-info">
                        <h2 class="section-title"><i class="fas fa-server"></i> Server Information</h2>
                        <div class="server-ip">
                            <div class="server-ip-title"><i class="fas fa-network-wired"></i> Primary Server IP</div>
                            <div class="server-ip-address">
                                phrustv2.hopto.org
                                <button class="copy-btn" data-ip="phrustv2.hopto.org">Copy</button>
                            </div>
                        </div>
                        <div class="server-ip">
                            <div class="server-ip-title"><i class="fas fa-globe"></i> Alternative IP 1</div>
                            <div class="server-ip-address">
                                mc.phrustv2.qzz.io
                                <button class="copy-btn" data-ip="mc.phrustv2.qzz.io">Copy</button>
                            </div>
                        </div>
                        <div class="server-ip">
                            <div class="server-ip-title"><i class="fas fa-gamepad"></i> Alternative IP 2</div>
                            <div class="server-ip-address">
                                play.phrustv2.qzz.io
                                <button class="copy-btn" data-ip="play.phrustv2.qzz.io">Copy</button>
                            </div>
                        </div>
                        <div class="description">
                            <i class="fas fa-quote-left"></i> This Minecraft Server Created By Jameszxc_. <i class="fas fa-quote-right"></i>
                        </div>
                    </div>
                    <div class="server-info">
                        <h3 class="section-title"><i class="fas fa-users"></i> Online Players</h3>
                        <div style="text-align: center; padding: 15px;">
                            <div style="font-size: 32px; color: #FF5252; font-weight: bold;" id="minecraftPlayers">24/50</div>
                            <div style="color: #b9bbbe; margin-top: 5px;">Players Online</div>
                        </div>
                    </div>
                    <div class="discord-profile">
                        <img src="https://ik.imagekit.io/x7wxtmxra/images.jpg" alt="Server Owner" class="discord-avatar">
                        <div class="discord-profile-info">
                            <h4>Jameszxc_</h4>
                            <p>Server Owner</p>
                            <div><span class="online-indicator"></span> Online</div>
                        </div>
                    </div>
                </aside>

                <main class="content">
                    <h2 class="section-title"><i class="fas fa-home"></i> Welcome to PhrustV2</h2>
                    <div class="discord-invite">
                        <div class="discord-header">
                            <div class="discord-icon">
                                <img src="https://ik.imagekit.io/x7wxtmxra/c61293e3ec5494dafade8929187016cd.webp" alt="Discord Server">
                            </div>
                            <div class="discord-info">
                                <h3 id="discordServerName">PhrustV2</h3>
                                <p id="discordServerDesc">Minecraft Survival Community</p>
                            </div>
                        </div>
                        <div class="discord-members">
                            <div class="member-count">
                                <span class="online-indicator"></span>
                                <strong id="onlineCount">Loading...</strong> Online â€¢ 
                                <strong id="totalMembers">Loading...</strong> Members
                            </div>
                        </div>
                        <button class="join-btn" id="discordInviteBtn">
                            <i class="fab fa-discord"></i> Join Discord
                        </button>
                    </div>
                    <div class="server-info">
                        <h3 class="section-title"><i class="fas fa-info-circle"></i> About Our Server</h3>
                        <p>Welcome to PhrustV2, a survival Minecraft server with a friendly community and exciting features.</p>
                    </div>
                </main>
            </div>
        </div>

        <!-- Unraidable Cave Page -->
        <div id="unraidable-cave-page" class="page">
            <div class="main-content">
                <aside class="sidebar">
                    <div class="server-info">
                        <h2 class="section-title"><i class="fas fa-info-circle"></i> Request Info</h2>
                        <h3 class="section-title"><i class="fas fa-exclamation-triangle"></i> Requirements</h3>
                        <ul style="padding-left: 20px; margin-bottom: 15px;">
                            <li>Must be active for at least 2 weeks</li>
                            <li>No recent bans or warnings</li>
                            <li>Provide detailed reasoning</li>
                            <li>Agree to server rules</li>
                        </ul>
                        <h3 class="section-title" style="margin-top: 20px;"><i class="fas fa-history"></i> Cooldown System</h3>
                        <p>You can only submit one request every 24 hours.</p>
                    </div>
                </aside>

                <main class="content">
                    <h2 class="section-title"><i class="fas fa-mountain"></i> Unraidable Cave Request</h2>
                    <div class="message success" id="successMessage">Your request has been submitted!</div>
                    <div class="message error" id="errorMessage">An error occurred.</div>
                    <div class="loader" id="requestLoader"></div>
                    <div class="cave-form">
                        <p>Request an unraidable cave for your base.</p>
                        <div class="form-group">
                            <label for="minecraftUsername"><i class="fas fa-user"></i> Minecraft Username *</label>
                            <input type="text" id="minecraftUsername" class="input-control" placeholder="YourMinecraftName" required>
                        </div>
                        <div class="form-group">
                            <label for="reason"><i class="fas fa-edit"></i> Why do you want an unraidable cave? *</label>
                            <textarea id="reason" class="form-control" placeholder="Explain your reasons..." required minlength="20"></textarea>
                        </div>
                        <button class="send-btn" id="sendRequestBtn">
                            <i class="fas fa-paper-plane"></i> Submit to Discord Bot
                        </button>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>PhrustV2 Minecraft Server &copy; 2023 | Created by Jameszxc_</p>
        </div>
    </footer>

    <script>
        // JSONP implementation
        let jsonpCallbackId = 0;
        
        function jsonp(url, callback) {
            const callbackName = 'jsonp_callback_' + jsonpCallbackId++;
            window[callbackName] = function(data) {
                callback(null, data);
                document.head.removeChild(script);
                delete window[callbackName];
            };
            
            const script = document.createElement('script');
            script.src = url + (url.includes('?') ? '&' : '?') + 'callback=' + callbackName;
            document.head.appendChild(script);
            
            // Timeout
            setTimeout(() => {
                if (window[callbackName]) {
                    callback(new Error('Timeout'), null);
                    document.head.removeChild(script);
                    delete window[callbackName];
                }
            }, 10000);
        }
        
        // Simple fetch with proxy fallback
        async function safeFetch(url, options = {}) {
            // Try direct fetch first
            try {
                const response = await fetch(url, options);
                if (response.ok) return await response.json();
            } catch (e) {
                console.log('Direct fetch failed, trying JSONP for GET requests');
            }
            
            // For GET requests, try JSONP
            if (!options.method || options.method === 'GET') {
                return new Promise((resolve, reject) => {
                    jsonp(url, (error, data) => {
                        if (error) reject(error);
                        else resolve(data);
                    });
                });
            }
            
            throw new Error('Failed to fetch');
        }
        
        // Discord stats
        async function updateDiscordStats() {
            try {
                // Try your server first
                const data = await safeFetch('http://sg-sgp05.altr.cc:25251/api/discord/stats');
                
                if (data && data.totalMembers) {
                    document.getElementById('onlineCount').textContent = data.onlineMembers || '0';
                    document.getElementById('totalMembers').textContent = data.totalMembers || '50';
                    document.getElementById('discordServerName').textContent = data.serverName || 'PhrustV2';
                }
            } catch (error) {
                console.log('Using fallback stats');
                document.getElementById('onlineCount').textContent = '89';
                document.getElementById('totalMembers').textContent = '127';
            }
        }
        
        // Submit request
        async function submitCaveRequest() {
            const minecraftUsername = document.getElementById('minecraftUsername').value.trim();
            const reason = document.getElementById('reason').value.trim();
            
            if (!minecraftUsername || !reason) {
                alert('Please fill all fields');
                return;
            }
            
            const loader = document.getElementById('requestLoader');
            loader.style.display = 'block';
            
            try {
                // Create a form to submit
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = 'http://sg-sgp05.altr.cc:25251/api/requests/submit';
                form.target = '_blank';
                
                const usernameInput = document.createElement('input');
                usernameInput.type = 'hidden';
                usernameInput.name = 'minecraftUsername';
                usernameInput.value = minecraftUsername;
                
                const reasonInput = document.createElement('input');
                reasonInput.type = 'hidden';
                reasonInput.name = 'reason';
                reasonInput.value = reason;
                
                form.appendChild(usernameInput);
                form.appendChild(reasonInput);
                document.body.appendChild(form);
                form.submit();
                document.body.removeChild(form);
                
                document.getElementById('successMessage').classList.add('show');
                document.getElementById('minecraftUsername').value = '';
                document.getElementById('reason').value = '';
                
            } catch (error) {
                document.getElementById('errorMessage').textContent = 'Failed to submit. Please join our Discord and use /request command directly.';
                document.getElementById('errorMessage').classList.add('show');
            } finally {
                loader.style.display = 'none';
            }
        }
        
        // Page navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(`${pageId}-page`).classList.add('active');
            
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === pageId) {
                    link.classList.add('active');
                }
            });
            
            window.location.hash = pageId;
        }
        
        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    showPage(this.getAttribute('data-page'));
                });
            });
            
            // Discord invite
            document.getElementById('discordInviteBtn').addEventListener('click', function() {
                window.open('https://dsc.gg/PHRUSTV2', '_blank');
            });
            
            // Copy IP buttons
            document.querySelectorAll('.copy-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const ip = this.getAttribute('data-ip');
                    navigator.clipboard.writeText(ip).then(() => {
                        const originalText = this.textContent;
                        this.textContent = 'Copied!';
                        setTimeout(() => this.textContent = originalText, 2000);
                    });
                });
            });
            
            // Send request
            document.getElementById('sendRequestBtn').addEventListener('click', submitCaveRequest);
            
            // Load Discord stats
            updateDiscordStats();
            
            // Set initial page
            const hash = window.location.hash.substring(1) || 'home';
            showPage(hash);
        });
        
        // Handle hash changes
        window.addEventListener('hashchange', function() {
            const hash = window.location.hash.substring(1) || 'home';
            showPage(hash);
        });
    </script>
</body>
</html>
